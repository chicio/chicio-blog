
<!--
AI Agent Instructions for chicio-blog
-->

# chicio-blog: AI Agent Coding Guide

This project is a Next.js (App Router) blog with a Matrix-inspired UI, using React, TailwindCSS, and Framer Motion. The codebase is modular, atomic, and highly type-safe. Follow these conventions and workflows for maximum productivity:

## Architecture & Structure

- **Atomic Design System**: UI is built from atoms, molecules, organisms, templates in `src/components/design-system`. Compose new UI from these layers.
- **Section Isolation**: Each main feature (blog, chat, art, etc.) lives in `src/components/sections/<section>`, with its own `components/` and `hooks/`.
- **Business Logic**: All core logic/utilities are in `src/lib` (e.g., post parsing, search, tracking, motion, local storage).
- **Types**: All shared types are in `src/types`. Update these when changing data models or tracked events.
- **Markdown Content**: Blog posts are Markdown files in `/posts` with frontmatter. Parsing is handled by `gray-matter` and custom logic in `src/lib/posts`.

## Developer Workflows

- **Install**: `npm install`
- **Dev server**: `npm run dev` (auto-generates search index)
- **Build**: `npm run build` (auto-generates search index)
- **Release**: `npm run release` (uses `release-it`)
- **Lint**: `npm run lint` (ESLint, config in `eslint.config.mjs`)
- **Search Index**: Generated by `npm run search-index` (runs `tsx src/lib/posts/search.ts` to create `public/search-index.json`)
- **CI/CD**: See `.github/workflows/build.yml` (runs on macOS, caches npm, builds with Upstash Vector secrets)

## Project Conventions

- **Glassmorphism & Motion**: Use `useGlassmorphism` and `useMotionSettings` for UI effects. Motion settings are stored in localStorage with a `fabrizioduroni_` prefix.
- **Tracking**: All navigation and UI actions are tracked via Google Analytics (gated by cookie consent). Use `trackWith` and update `src/types/tracking.ts` for new events.
- **Menu & Navigation**: Main menu is in `design-system/organism/menu.tsx` (uses `MenuItemWithTracking`). Add new sections in `src/types/slug.ts` and register in the menu.
- **Chat**: Uses `@ai-sdk/groq` and `@ai-sdk/react`. Chat UI is in `sections/chat/components`, state in `useFabrizioChat`.
- **Search**: Powered by `elasticlunr`, index built from Markdown frontmatter and stored in `public/search-index.json`.
- **Easter Eggs**: Special features (Matrix rain, white rabbit, etc.) are in `sections/easter-eggs`.

## Integration & External Dependencies

- **Next.js**: App Router in `src/app`. Update routes/layouts here.
- **TailwindCSS**: Utility-first styling, config in `tailwind.config.mjs`.
- **Framer Motion**: For all UI animation.
- **Markdown Rendering**: Uses `remark`, `rehype`, `katex`, and plugins for math, emoji, GFM, syntax highlighting.
- **Upstash Vector**: Used in CI for search/chat (secrets required).

## Examples

- **Add blog post**: Place Markdown in `/posts` with frontmatter (see existing posts). Search index updates on next build/dev.
- **Add section**: Create `src/components/sections/<name>`, add `components/` and `hooks/` as needed. Register in menu and `src/types/slug.ts`.
- **Extend design system**: Add to `design-system/atoms`, compose in molecules/organisms/templates.
- **Tracked navigation**: Use `MenuItemWithTracking`, update `src/types/tracking.ts` for new actions.

---
For more, see `README.md`, `src/types`, and `src/lib`. Keep this file up to date with new patterns or workflows.